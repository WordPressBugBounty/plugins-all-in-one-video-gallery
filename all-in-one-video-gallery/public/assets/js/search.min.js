!function(e){"use strict";var t={bar:null,timer:null,progress:0,init:function(){this.bar=document.querySelector(".aiovg-filters-progress-bar-inner"),this.progress=0,document.querySelector(".aiovg-filters-progress-bar").style.display="block",this.bar.style.width="0%",this.simulateProgress()},simulateProgress:function(){var e=this;this.timer=setInterval(function(){e.progress+=Math.floor(10*Math.random())+5,e.progress>=90&&(e.progress=90,clearInterval(e.timer)),e.bar.style.width=e.progress+"%"},200)},complete:function(){clearInterval(this.timer),this.progress=100,this.bar.style.width="100%",setTimeout(function(){document.querySelector(".aiovg-filters-progress-bar").style.display="none"},500)}};e(function(){var r=window.aiovg_search||window.aiovg_public;e(".aiovg-search-form-mode-live").each(function(){var t=e(this).find("form"),r=function(){t.submit()};t.find('input[name="vi"]').on("keydown",function(e){13===e.keyCode&&r()}).on("blur",r),t.find('input[type="checkbox"]').on("change",r),t.find("select").on("change",r)}),e(".aiovg-search-form-mode-ajax").each(function(){var i=e(this),o=i.closest(".aiovg-videos-filters-wrapper"),a=i.find("form"),n=i.hasClass("aiovg-search-form-template-compact")?"compact":null,s=o.data("params")||{};s.action="aiovg_load_videos",s.security=r.ajax_nonce;var c=null,l=null,u=function(e){return a.serializeArray().map(e=>[e.name,e.value]).sort((e,t)=>e[0]===t[0]?e[1].localeCompare(t[1]):e[0].localeCompare(t[0]))},f=u(a),g=function(){var e=u(a);if(f.length!==e.length)return!0;for(var t=0;t<f.length;t++)if(f[t][0]!==e[t][0]||f[t][1]!==e[t][1])return!0;return!1},d=function(u){u&&u.preventDefault(),clearTimeout(l),l=setTimeout(()=>{t.init(),i.trigger("aiovg-search-loading");var l=e.extend({},s);if(a.serializeArray().forEach(function(e){var t=e.name,r=e.value;switch(t){case"vi":l.search_query=r;break;case"sort":var i=r.split("-");l.orderby=i[0]||s.orderby,l.order=i[1]||s.order}}),a.find(".aiovg-field-category").length>0){var u=[];a.find('.aiovg-field-category input[type="checkbox"]:checked').each(function(){u.push(e(this).val())}),l.category=u}if(a.find(".aiovg-field-tag").length>0){var f=[];a.find('.aiovg-field-tag input[type="checkbox"]:checked').each(function(){f.push(e(this).val())}),l.tag=f}var d=g();"compact"===n?(a.find(".aiovg-button-submit").prop("hidden",d),a.find(".aiovg-button-reset").prop("hidden",!d)):a.find(".aiovg-field-reset").prop("hidden",!d),null!==c&&c.abort(),c=e.post(r.ajax_url,l,function(e){c=null,e&&e.data&&e.data.html&&o.find(".aiovg-videos").replaceWith(e.data.html),t.complete(),i.trigger("aiovg-search-complete")}).fail(function(e){c=null,0===e.status||429===e.status&&console.warn("Too many requests (429). Request throttled."),t.complete(),i.trigger("aiovg-search-failed")})},400)};a.find('input[name="vi"]').on("keydown",function(e){13===e.keyCode&&d()}).on("blur",d),a.find("select").on("change",d),a.on("submit",d);var h=a.find('input[type="checkbox"]');h.on("change",d),a.find(".aiovg-button-reset").on("click",function(e){e.preventDefault(),a[0].reset(),h.off("change",d),h.trigger("change"),h.on("change",d),d()}).removeAttr("onclick")})})}(jQuery);