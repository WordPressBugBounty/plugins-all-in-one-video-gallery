!function(e){"use strict";function a(e){var a;if(a)return a.open(),!1;(a=wp.media.frames.file_frame=wp.media({frame:"post",state:"insert",multiple:!1})).on("insert",function(){var i=a.state().get("selection").first().toJSON();if(0==i.url.trim().length)return!1;e(i)}),a.state("embed").on("select",function(){var i=a.state().props.toJSON();if(0==i.url.trim().length)return!1;i.id=0,e(i)}),a.on("open",function(){jQuery("#menu-item-gallery, #menu-item-playlist, #menu-item-video-playlist").hide()}),a.open()}function i(a){a.autocomplete({source:function(a,i){e.ajax({url:ajaxurl,dataType:"json",method:"post",data:{action:"aiovg_autocomplete_get_videos",security:aiovg_admin.ajax_nonce,term:a.term},success:function(a){i(e.map(a,function(e){return{label:e.post_title,value:e.post_title,data:e}}))}})},autoFocus:!0,minLength:0,select:function(a,i){var t=e(this).closest(".aiovg-widget-field"),o="";0!=i.item.data.ID?(o='<span class="dashicons dashicons-yes-alt"></span> ',o+="<span>"+i.item.data.post_title+"</span> ",o+='<a href="javascript:void(0);" class="aiovg-remove-autocomplete-result">'+aiovg_admin.i18n.remove+"</a>"):(o='<span class="dashicons dashicons-info"></span> ',o+="<span>"+aiovg_admin.i18n.no_video_selected+"</span>"),t.find(".aiovg-widget-input-id").val(i.item.data.ID).trigger("change"),t.find(".aiovg-autocomplete-result").html(o)},open:function(){e(this).removeClass("ui-corner-all").addClass("ui-corner-top")},close:function(){e(this).removeClass("ui-corner-top").addClass("ui-corner-all"),e(this).val("")}})}function t(e){var a=document.createElement("input");a.value=e,document.body.appendChild(a),a.focus(),a.select(),document.execCommand("copy"),a.remove(),alert(aiovg_admin.i18n.copied+"\n"+e)}e.fn.aiovgReplaceClass=function(e,a){return this.removeClass(function(a,i){var t=i.match(e);return t?t.join(" "):""}).addClass(a),this},e(function(){var o,s;e(document).on("click",".aiovg-upload-media",function(i){i.preventDefault();var t=e(this);a(function(e){t.closest(".aiovg-media-uploader").find("input[type=text]").val(e.url).trigger("file.uploaded")})}),e.fn.wpColorPicker&&(e(".aiovg-color-picker").wpColorPicker(),e(document).on("widget-added widget-updated",function(a,i){i.find(".aiovg-color-picker").wpColorPicker({change:_.throttle(function(){e(this).trigger("change")},3e3)})})),e.fn.magnificPopup&&e(".aiovg-modal-button").magnificPopup({type:"inline",mainClass:"mfp-fade"}),e("#aiovg-shortcode-selector input[type=radio]").on("change",function(){var a=e("#aiovg-shortcode-selector input[type=radio]:checked").val();e(".aiovg-shortcode-form").hide(),e("#aiovg-shortcode-form-"+a).show(),e(".aiovg-shortcode-instructions").hide(),e("#aiovg-shortcode-instructions-"+a).show()}).trigger("change"),e("#aiovg-shortcode-forms .aiovg-shortcode-section-header").on("click",function(){var a=e(this),i=a.parent();i.hasClass("aiovg-active")||a.closest(".aiovg-shortcode-form").find(".aiovg-active").removeClass("aiovg-active").find(".aiovg-shortcode-controls").slideToggle(),i.toggleClass("aiovg-active").find(".aiovg-shortcode-controls").slideToggle()}),e("#aiovg-shortcode-form-video select[name=type]").on("change",function(){var a=e(this).val();e("#aiovg-shortcode-form-video").aiovgReplaceClass(/\aiovg-type-\S+/ig,"aiovg-type-"+a)}),e("#aiovg-shortcode-form-videos select[name=template]").on("change",function(){var a=e(this).val();e("#aiovg-shortcode-form-videos").aiovgReplaceClass(/\aiovg-template-\S+/ig,"aiovg-template-"+a)}).trigger("change"),e("#aiovg-shortcode-form-categories select[name=template]").on("change",function(){var a=e(this).val();e("#aiovg-shortcode-form-categories").aiovgReplaceClass(/\aiovg-template-\S+/ig,"aiovg-template-"+a)}).trigger("change"),e("#aiovg-generate-shortcode").on("click",function(a){a.preventDefault();var i=e("#aiovg-shortcode-selector input[type=radio]:checked").val(),t=i,o={};for(var s in e(".aiovg-shortcode-field","#aiovg-shortcode-form-"+i).each(function(){var a=e(this),i=a.attr("type"),t=a.attr("name"),s=a.val(),n=0;void 0!==a.data("default")&&(n=a.data("default")),"checkbox"==i?s=a.is(":checked")?1:0:("category"==t||"tag"==t)&&(s=a.find("input[type=checkbox]:checked").map(function(){return this.value}).get().join(",")),s!=n&&(o[t]=s)}),o)o.hasOwnProperty(s)&&(t+=" "+s+'="'+o[s]+'"');e("#aiovg-shortcode").val("[aiovg_"+t+"]")}),e("#aiovg-issues-check-all").on("change",function(){var a=!!e(this).is(":checked");e("#aiovg-issues .aiovg-issue").prop("checked",a)}),e("#aiovg-issues-form").submit(function(){if(!(e("#aiovg-issues .aiovg-issue:checked").length>0))return alert(aiovg_admin.i18n.no_issues_selected),!1}),e(".aiovg-copy-url").on("click",function(){t(e(this).data("url"))}),e(".aiovg-copy-shortcode").on("click",function(){var a;t('[aiovg_video id="'+parseInt(e(this).data("id"))+'"]')}),e("#aiovg-video-type").on("change",function(a){a.preventDefault();var i=e(this).val();e(".aiovg-toggle-fields").hide(),e(".aiovg-type-"+i).show(300)}).trigger("change"),e("#aiovg-add-new-source").on("click",function(a){a.preventDefault();var i=e(this),t=parseInt(e(this).data("limit")),o=e("#aiovg-field-mp4 .aiovg-quality-selector").length,s=o-1;0==s&&e("#aiovg-field-mp4 .aiovg-quality-selector").show();var n=e("#aiovg-source-clone .aiovg-source").clone();n.find("input[type=radio]").attr("name","quality_levels["+s+"]"),n.find("input[type=text]").attr("name","sources["+s+"]"),i.before(n),o+1>=t&&i.hide()}),e("#aiovg-field-mp4").on("change",".aiovg-quality-selector input[type=radio]",function(){var a=e(this),i=[];e(".aiovg-quality-selector").each(function(){var t=e(this).find("input[type=radio]:checked").val();t&&(i.includes(t)?(a.prop("checked",!1),alert(aiovg_admin.i18n.quality_exists)):i.push(t))})}),e("#aiovg-add-new-track").on("click",function(a){a.preventDefault();var i=e("#aiovg-tracks-clone tr").clone();e("#aiovg-tracks").append(i)}),0==e("#aiovg-tracks .aiovg-tracks-row").length&&e("#aiovg-add-new-track").trigger("click"),e(document).on("click",".aiovg-upload-track",function(i){i.preventDefault();var t=e(this);a(function(e){t.closest("tr").find(".aiovg-track-src input[type=text]").val(e.url)})}),e(document).on("click",".aiovg-delete-track",function(a){a.preventDefault(),e(this).closest("tr").remove()}),e.fn.sortable&&((o=e("#aiovg-tracks tbody")).hasClass("ui-sortable")&&o.sortable("destroy"),o.sortable({handle:".aiovg-handle"})),e("#aiovg-add-new-chapter").on("click",function(a){a.preventDefault();var i=e("#aiovg-chapters-clone tr").clone();e("#aiovg-chapters").append(i)}),0==e("#aiovg-chapters .aiovg-chapters-row").length&&e("#aiovg-add-new-chapter").trigger("click"),e(document).on("click",".aiovg-delete-chapter",function(a){a.preventDefault(),e(this).closest("tr").remove()}),e.fn.sortable&&((s=e("#aiovg-chapters tbody")).hasClass("ui-sortable")&&s.sortable("destroy"),s.sortable({handle:".aiovg-handle"})),e("#aiovg-field-access_control select").on("change",function(){2==parseInt(e(this).val())?e("#aiovg-field-restricted_roles").show():e("#aiovg-field-restricted_roles").hide()}),e("#aiovg-categories-upload-image").on("click",function(i){i.preventDefault(),a(function(a){e("#aiovg-categories-image-wrapper").html('<img src="'+a.url+'" alt="" />'),e("#aiovg-categories-image").val(a.url),e("#aiovg-categories-image_id").val(a.id),e("#aiovg-categories-upload-image").hide(),e("#aiovg-categories-remove-image").show()})}),e("#aiovg-categories-remove-image").on("click",function(a){a.preventDefault(),e("#aiovg-categories-image-wrapper").html(""),e("#aiovg-categories-image").val(""),e("#aiovg-categories-image_id").val(""),e("#aiovg-categories-remove-image").hide(),e("#aiovg-categories-upload-image").show()}),e(document).ajaxComplete(function(a,i,t){if(e("#aiovg-categories-image").length&&t.data){var o=t.data.split("&");-1!==e.inArray("action=add-tag",o)&&e(i.responseXML).find("term_id").text()&&(e("#aiovg-categories-image-wrapper").html(""),e("#aiovg-categories-image").val(""),e("#aiovg-categories-image_id").val(""),e("#aiovg-categories-remove-image").hide(),e("#aiovg-categories-upload-image").show(),e("#aiovg-categories-exclude_search_form").prop("checked",!1),e("#aiovg-categories-exclude_video_form").prop("checked",!1))}}),e("#aiovg-settings .form-table").each(function(){var a=e(this).find("tr:first th label").attr("for").split("[");a=a[0].replace(/_/g,"-"),e(this).attr("id",a)}),e("#aiovg-player-settings tr.player input[type=radio]").on("change",function(){var a=e("#aiovg-player-settings tr.player input[type=radio]:checked").val();e("#aiovg-player-settings").aiovgReplaceClass(/\aiovg-player-\S+/ig,"aiovg-player-"+a)}).trigger("change"),e("#aiovg-categories-settings tr.template select").on("change",function(){var a=e(this).val();e("#aiovg-categories-settings").aiovgReplaceClass(/\aiovg-template-\S+/ig,"aiovg-template-"+a)}).trigger("change"),e("#aiovg-videos-settings tr.template select").on("change",function(){var a=e(this).val();e("#aiovg-videos-settings").aiovgReplaceClass(/\aiovg-template-\S+/ig,"aiovg-template-"+a)}).trigger("change"),e("#aiovg-restrictions-settings tr.access_control select").on("change",function(){2==parseInt(e(this).val())?e("#aiovg-restrictions-settings tr.restricted_roles").show():e("#aiovg-restrictions-settings tr.restricted_roles").hide()}).trigger("change"),e(document).on("change",".aiovg-widget-form-categories .aiovg-widget-input-template",function(){var a=e(this).val();e(this).closest(".aiovg-widget-form-categories").aiovgReplaceClass(/\aiovg-template-\S+/ig,"aiovg-template-"+a)}),e(document).on("change",".aiovg-widget-form-videos .aiovg-widget-input-template",function(){var a=e(this).val();e(this).closest(".aiovg-widget-form-videos").aiovgReplaceClass(/\aiovg-template-\S+/ig,"aiovg-template-"+a)}),e.fn.autocomplete&&(e(".aiovg-autocomplete-input").each(function(){i(e(this))}),e(document).on("widget-added widget-updated",function(e,a){var t=a.find(".aiovg-autocomplete-input");t.length>0&&i(t)}),e(document).on("click",".aiovg-remove-autocomplete-result",function(){var a=e(this).closest(".aiovg-widget-field"),i='<span class="dashicons dashicons-info"></span> ';i+="<span>"+aiovg_admin.i18n.no_video_selected+"</span>",a.find(".aiovg-widget-input-id").val(0).trigger("change"),a.find(".aiovg-autocomplete-result").html(i)}))})}(jQuery);